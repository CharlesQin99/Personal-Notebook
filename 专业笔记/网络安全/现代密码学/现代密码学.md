# 现代密码学

## 基本概念

![](PIC\0.png)

![1](PIC\1.png)

**密码学 = 算法 ＋协议**

![](PIC\2.png)

![](PIC\3.png)

## 中国古代密码

![5](PIC\5.png)

![](PIC\4.png)

![](PIC\6.png)

**六韬**：《六韬》是**姜子牙**创作的文学作品，**<u>武经七书之一</u>**

《六韬》《司马法》都是**姜子牙**写的

> **《武经七书》**是北宋朝廷作为官书颁行的兵法丛书，是中国古代第一部军事教科书集。它由**《孙子兵法》《吴子兵法》《六韬》《司马法》《三略》《尉缭子》《李卫公问对》（唐太宗李世民与李靖讨论军事问题的言论辑录。）**七部著名兵书汇编而成。

![](PIC\8.png)

![](PIC\7.png)

**武经总要**

![](PIC\9.png)

![](PIC\10.png)

![11](PIC\11.png)

**反切码**

![12](PIC\12.png)

## 外国古代密码

![](PIC\14.png)

![](PIC\15.png)

![16](PIC\16.png)

**凯撒密码**：字母表**整体往后移３位**

![17](PIC\17.png)

![](PIC\18.png)

![19](PIC\19.png)

![](PIC\20.png)

**托马斯．杰佛逊：美国<u>第三代总统，《独立宣言》主要作者</u>**

![21](PIC\21.png)

**Enigma密码机**

![](PIC\22.png)

![23](PIC\23.png)

## 现代密码

近代密码

- 1800年-1949年
- 密码机迅速发展，数学家加入密码队伍

![](PIC\24.png)

### 里程碑

现代密码

**1949年**，香农发表了**《保密系统的通信理论》**

![](PIC\25.png)

![](PIC\26.png)

![](PIC\27.png)

**后量子密码学**

公钥密码未来发展方向，**为了对抗量子计算机模型对传统公钥密码安全性的威胁**

![](PIC\29.png)

1994年，量子计算机模型**威胁到传统的公钥密码，此后开始<u>后量子密码学</u>**

![](PIC\28.png)

## 密码分析学

密码学分为两个分支：既对立又统一

- **密码分析学**
- **密码编码学**

![](PIC\30.png)

目标：

- **恢复合法密文相应的明文**
- **恢复密钥**

### 密码体制的攻击方法

- 穷举攻击
- 统计分析攻击
- 解密变换攻击

![](PIC\31.png)

**侧信道攻击**：利用物理方法的攻击

从敌手获得的资源来分：

![](PIC\32.png)

#### 唯密文攻击

知道的信息最少，仅知道密文，最弱的攻击手段

![](PIC\33.png)

#### 已知明文攻击

黑客知道**一些明文和对应的密文**

![](PIC\34.png)

#### 选择明文攻击

黑客可以选择一些明文得到对应的密文，从而确定出密钥结构

![35](PIC\35.png)

#### 选择密文攻击

选择一些密文得到对应的明文

![](PIC\36.png)

### 安全性

![](PIC\37.png)

![](PIC\38.png)

## 古典密码算法

### 置换密码

![](PIC\39.png)

**天书（Scytale）**

**<u>木棒直径需要保密</u>**

![](PIC\40.png)

### 代替密码

![](PIC\41.png)

## 单表代替密码

### 加法密码

如**<u>凯撒密码</u>**

![](PIC\42.png)

### 乘法密码

因为k要与26互素，所以只有12种

![](PIC\43.png)

### 仿射密码

**原理：加法密码 + 乘法密码**

![44](PIC\44.png)

## 多表代换密码

很多现代密码的基础原理

![](PIC\45.png)

例：

![](PIC\46.png)

![](PIC\47.png)

解密过程：

![](PIC\48.png)

![49](PIC\49.png)

## 流密码

**流密码的核心问题：**

如果Vernam密码体制中的密钥流是完全随机的，那么这种加密体制就是绝对安全的（理论上不可破译）。然而，完全随机的无限长的密钥流的生成、分发和存储是非常困难的。因此，我们需要采用另外一种思路来生成接近随机的密钥流。

我们需要**<u>使用有限长的种子密钥（易生成、分发、存储），来生成无限长的随机密钥序列</u>**——我们称拥有这种功能的算法为**伪随机序列发生器**。如何设计高效而又安全的伪随机数发生器，是流密码的核心研究内容。

> “伪随机序列”加一个“伪”字，是因为伪随机序列发生器**<u>*生成的随机序列并不是完全随机的*</u>**。它往往**拥有一定的周期性，只能做到在窃取较短的一段序列时，不会泄露太多信息而已**。

### 一次一密

主要思想：**一次一密**

一次一密：**无条件安全的，<u>密钥随机产生且只使用一次</u>**

**加密**：密文 = （明文+密钥）% 26

**解密**：明文 = （密文-密钥）% 26

![](PIC\50.png)

缺点：**密钥长度要和明文一样，共享很困难**

![](PIC\51.png)

流密码概况

![](PIC\52.png)

核心：产生**<u>*密钥流* + 内部记忆元件</u>**

![](PIC\53.png)

![](PIC\54.png)

### 同步流密码

![](PIC\55.png)

![](PIC\56.png)

![](PIC\57.png)

![](PIC\58.png)

## 有限状态自动机

**FSM "finite state machine"**

![59](PIC\59.png)

密钥流生成器可以看成**<u>参数为k的有限状态机</u>**

![](PIC\60.png)

![61](PIC\61.png)

![62](PIC\62.png)

![](PIC\63.png)

## 二元序列的伪随机性

![](PIC\64.png)

![](PIC\65.png)

### 自相关函数

![](PIC\97.png)

![](PIC\66.png)

### 伪随机公设

![](PIC\67.png)

定义：

![](PIC\68.png)

**实际应用中应该满足的其他条件：**

![](PIC\70.png)

## 线性反馈移位寄存器

### 反馈移位寄存器

每个存储器存储一个bit

步骤：

1. **a1-an存储器都有一个初始值**
2. **输入到反馈函数中计算输出**
3. **输出a1，a2移到a1...an到an-1，**
4. **将反馈函数计算出来的值放入an位**

![](PIC\71.png)

![](PIC\72.png)

**反馈函数**

**<u>LFSR的周期与其反馈函数有很密切的关系，反馈函数决定了LFSR的循环序列</u>**

![](PIC\73.png)

例：

周期为4的输出序列

![](PIC\74.png)

**线性反馈移位寄存器的概念**

**LFSR**：实现简单，速度快，较为成熟的理论，**可以<u>构成周期序列</u>，构成密钥流生成器的最重要部件**

**<u>所谓线性：反馈函数是一个线性函数</u>**

性质：

- 系数至少一个不为0
- 输出性质完全由反馈函数决定
- n级LFSR最多2^n个状态数
- 状态周期 < 2^n -1

> 如果生成序列**周期数达到最大的2^n -1**，则称这个序列为**m序列**

![](PIC\79.png)

![](PIC\75.png)

**反馈函数**

![](PIC\76.png)

例：

![](PIC\77.png)

![](PIC\78.png)

### m-序列

m序列是由n级线性移位寄存器产生的**周期**为**P=2^n−1**的**伪随机序列码**，是**最长线性移位寄存器序列**的简称

m序列在通信领域有着广泛的应用，如扩频通信、卫星通信的码分多址（CDMA），数字数据中的加密、加扰、同步、误码率测量等领域。

> m序列是**最长线性移位寄存器序列**的简称。顾名思义，m序列是由多级移位寄存器或其延迟元件通过线性反馈产生的最长的码序列。在二进制移位寄存器中，若n为移位寄存器的级数，n级移位寄存器共有 2^n 个状态，除去全0状态外还剩下 2^n-1 种状态，因此它能产生的最大长度的码序列为 2^n-1 位，也就是说，一个n级线性反馈移位寄存器产生的最长周期等于 2^n-1 

![](PIC\80.png)

#### 特征多项式

![](PIC\98.png)

![](PIC\81.png)

**反馈函数特征多项式的阶，就是<u>LFSR产生序列的周期</u>**

**n级循环序列发生器的模型**

![](PIC\89.png)

![](PIC\84.png)

![](PIC\85.png)

 **n级线性反馈移位寄存器产生m序列（P=2^n-1[m序列的周期]）的充要条件：<u>移位寄存器的特征多项式F(x)为本原多项式</u>。**

#### 本原多项式

**m序列LFSR反馈函数对应的特征多项式被称为本原多项式**。

目的：**当特征多项式是本原多项式，可以使得输出序列达到<u>*最大周期*</u>**

![](PIC\86.png)

这样产生m序列的充要条件就变成了**如何寻找本原多项式**

求法：**1/F(x)作多项式长除法得到的商多项式系数序列就是m序列（本原多项式的倒数）。**

![](PIC\87.png)

例：

![](PIC\88.png)

#### 伪随机性

回顾**随机性公设**

![](PIC\90.png)

若序列**异相自相关函数值 = -1，则为伪随机序列**

![](PIC\91.png)

#### 安全性

![](PIC\92.png)

##### **方程解法**

例：

![](PIC\93.png)

![](PIC\94.png)

![95](PIC\95.png)

##### BM算法

**给定一个长为N的二元序列a，如何求出<u>*产生这一序列且最小级数*</u>的线性移位寄存器**

![](PIC\96.png)

### 密钥流攻击

![99](PIC\99.png)

**利用周期推导出级数n，然后转变为问题2求解**

![100](C:\CHARLES\Personal\专业\网络安全\现代密码学\PIC\100.png)

## 非线性序列

![](PIC\101.png)

### Geffe序列生成器

**3个LFSR**组成的，其中**一个作为控制生成器使用**。

![](PIC\109.png)

周期为**3个LSFR的最小公倍数**

实现了**周期的极大化**，且0与1分布大体平衡

![](PIC\102.png)

![](PIC\103.png)

### J-K触发器

由**两个LFSR**构成，具有良好的统计特性。

缺点：**不能抵抗Ross Anderson的<u>中间相遇一致性攻击和线性一致性攻击</u>**

![](PIC\104.png)

![](PIC\105.png)

例：

![106](PIC\106.png)

**弱点：**

![](PIC\107.png)

### Pless生成器

**由8个LFSR,4个J-K触发器和一个循环计数器构成**

**<u>多个J-K触发器序列驱动的多路复合序列方案</u>**。为了解决一个J-K触发器就可以**通过密码分析的方式破解得到ak和bk序列的缺点**

![](PIC\108.png)

### 钟控序列生成器

**本质：两个LFSR。用一个LFSR控制另一个LFSR的移位时钟脉冲**

![](PIC\110.png)

![](PIC\111.png)

![](PIC\112.png)

例：

![113](PIC\113.png)

![114](PIC\114.png)

![](PIC\115.png)

![116](PIC\116.png)

{an} = 0 1 1 0 1 1 · · ·
{bn} = 1 1 1 0 1 0 0 1 1 1 0 1 0 0 · · ·

**核心思想**

- **a = 1时，进行一次<u>移位</u>，输出 {bn} 序列的值**
- **a = 0时，移位时钟脉冲无法通过与门影响LFSR2，重复输出前一位**

步骤：

1. 输出序列{dn}第一位的值，首位比较不同， d1 = b1 
2. 确定 {dn} 第二位 d2 时，先获取 a1 的值，如果值是 0 时， d2 = d1 （即 dk 填入 dk-1 的值）
3. 确定 {dn} 第三位 d3 时，得到 a2 的值为 1 ，此时就和上一步不同。得输出 {bn} 序列的值，因为之前输出过了 b1 的值，所以不能再用这个 b1 值，则 d3 = b2 
4. 求取的方法和步骤 3 和 4 类似，当前的 a 值为 1 ，所以得输出最新的 b 值来当作d4的值。

![](PIC\117.png)

### A5算法

A5算法是**GSM 系统**中要使用的**序列密码加密算法**之一，**<u>用于加密手机终端基站之间的传输的语音和数据</u>**，目前已被攻破。

该算法由一个22bit长的参数(帧号码, Fn)和64 bit长的参数(会话密钥,Kc)生成两个114 bit长的序列(密钥流)，然后与GSM会话每帧（228 bit/帧）异或。

![](PIC\118.png)

![](PIC\119.png)

![](PIC\120.png)

![](PIC\121.png)

![](PIC\125.png)

![](PIC\122.png)

- 基本密钥**KA1**：**SIM卡中**，用于基站和用户之间的会话
- 会话密钥**k**：基站生成的**64bit的随机数**，**利用基本密钥KA1**，使用其他密码算法将k加密传给用户，用户端用KA1解密即可得到会话密钥，**只限于一次通话**
- 明文处理：按照**每帧228bit**分为若干帧加密

**步骤**：

1. 初始化：利用会话密钥k和帧序号**设定三个LFSR的起点**，并将其都设置为全零向量
2. 三个LFSR规则动作64次，第i步时，三个LFSR的反馈内容都首先和密钥的第i比特异或，并将异或结果作为LFSR反馈的内容![](PIC\123.png)
3. **帧序号参与**![](PIC\124.png)

**缺点**

![](PIC\126.png)

## 分组密码

可以构造：

- **伪随机数生成器**
- **流密码**
- 消息认证码和杂凑函数

![](PIC\127.png)

将明文**按组来加密**，**<u>明文长度和密文长度不一定相等</u>**

![](PIC\128.png)

![](PIC\129.png)

![](PIC\130.png)

![](PIC\131.png)

### SPN

**SP网络**，代换（Substitution）和置换（Permutation）分别被称作S盒（替换盒，英语：S-boxes）和P盒（排列盒，英语：P-boxes）,又称为**替代-置换网络**

> **S盒的指标的好坏直接决定了密码算法的好坏**，它们应该尽可能地**<u>非线性</u>**（输入和输出应该与复杂方程相关），并且**<u>没有统计偏差</u>**（这意味着改变任意一个输入比特都将潜在地影响输出比特）

- **代换集合**
- **解密变换集（逆代换网络）**
- **密文**
- **恢复的明文**

![](PIC\132.png)

![](PIC\133.png)

![](PIC\135.png)

![](PIC\136.png)

SPN的**核心思想**：现在用**另一种算法来替代我们的表格**，我们虽然还不知道我们的算法是什么，但是我们希望我们的算法具有一定的随机性，就算输入的两个值差异很小，对应输出的ciphertext也要有很大的差异性。 

> 一个很经典的方法就是将我们的block拆分成长度相等的小型block，比方说，当我们block长度为128时候，我们就可以**拆分为16个8 bits的更小的block** 。我们对每一个进行加密，最后**将这些block用一种特定的方法组装起来。**
>
> 注意，最后的组装并不是直接将所有按照顺序拼装起来（不然，这样就等价于block长度为8了）。拼装方法不唯一，但要保证输入值中的每一个bit都能对输出值的所有bit产生影响。
>
> 最后，我们重复刚才拆分拼装的步骤多次。

![](PIC\137.png)

#### **AES**

[AES加密算法动画演示_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1jY411P7Vv/?spm_id_from=333.788.recommend_more_video.4&vd_source=9dea3d2a047ac9de9cb6758667ca19c8)

AES：密码学中的**高级加密标准**（Advanced Encryption Standard，**AES**），又称**Rijndael加密法**，是美国联邦政府采用的一种**区块加密标准**

> AES是用来**<u>替代原先的DES</u>**

每一个字节看作**2^8有限域**的元素

由于**GF(2)**的加法，即**模2加法与异或(XOR)门**等价，GF(2)的**乘法与逻辑与(AND)门**等价，所以GF(2)对AES非常重要。

**素域简介**

> **有限域有时也称伽罗瓦域，它指的是由有限个元素组成的集合，在这个集合内可以执行加、减、乘和逆运算。而在密码编码学中，我们只研究拥有有限个元素的域，也就是有限域。域中包含元素的个数称为域的阶。只有当m是一个素数幂时，即m=p^n(其中n为正整数是p的次数，p为素数)，阶为m的域才存在。p称为这个有限域的特征。**
>
> **也就是说，有限域中元素的个数可以是11(p=11是一个素数,n=1)、可以是81(p=3是一个素数，n=4)、也可以是256(p=2是一个素数，n=8).....但有限域的中不可能拥有12个元素，因为12=2·2·3，因此12也不是一个素数幂。**
>
> **有限域中最直观的例子就是阶为素数的域，即n=1的域。域GF(p)的元素可以用整数0、1、...、p-1l来表示。域的两种操作就是模整数加法和整数乘法模p。加上p是一个素数，整数环Z表示为GF(p)，也成为拥有素数个元素的素数域或者伽罗瓦域。GF(p)中所有的非零元素都存在逆元，GF(p)内所有的运算都是模p实现的。**
>
> **素域内的算数运算规则如下：(1)加法和乘法都是通过模p实现的；(2)任何一个元素a的加法逆元都是由a+(a的逆元)=0 mod p得到的；(3)任何一个非零元素a的乘法逆元定义为a·a的逆元=1。举个例子，在素域GF(5)={0、1、2、3、4}中，2的加法逆元为3，这是因为2+(3)=5，5mod5=0,所以2+3=5mod5=0。2的乘法逆元为3，这是因为2·3=6，6mod5=1，所以2·3=6mod5=1。(在很多地方a的加法逆元用-a表示，a的乘法逆元用1/a表示)**
>
> **注：GF(2)是一个非常重要的素域，也是存在的最小的有限域，由于GF(2)的加法，即模2加法与异或(XOR)门等价，GF(2)的乘法与逻辑与(AND)门等价，所以GF(2)对AES非常重要。**

![](PIC\154.png)

![](PIC\155.png)

**逆元**

![](PIC\156.png)

![](PIC\157.png)

##### 加密标准

**<u>密钥的长度不同，推荐加密轮数也不同</u>**

![](PIC\162.png)

##### 分组加密模式

AES的分组长度是**128bit**，三种可选密钥长度**128bit,192bit和256bit**，轮数分别为**10、12和14**
分组加密常见五种工作模式:

**ECB** (ElectronicCodebook，电子密码本)
优点:**简单、可并行计算、误差不传递**
缺点:**不能隐藏明文模式(比如图像加密轮廓仍在)、主动攻击（改明文，后续内容不影响，只要误差不传递该缺点就存在)**
用途:**需要并行加密的应用**

**CBC** (Cipher Block Chaining,密码分组链接)∶
优点:**不容易主动攻击（误差传递)、适合长报文，是SSL、IPSec标准**
缺点:**无法并行、误差传递**
用途:**长报文传输,SSL和IPSec**

**CFB** (CipherFeedback，密码反馈)︰
优点:**不容易主动攻击（误差传递)，分组转变为流模式，可加密小于分组数据**缺点:**无法并行、误差传递**

**OFB** (OutputFeedback，输出反馈)︰
优点:**分组转为流模式、可加密小于分组数据**
缺点:**主动攻击(改明文，后续内容不影响，只要误差不传递该缺点就存在)
用途:通信信道质量不高时使用，比如卫星通信**

**CTR** (Counter，计数器模式)∶
描述:计算器模式不常见，在CTR模式中，有一个自增的算子，这个算子用密钥加密之后的输出和明文异或的结果得到密文，相当于**一次一密**。这种加密方式**简单快速，安全可靠，而且可以并行加密**，但是在计算器不能维持很长的情况下，密钥**只能使用一次**。
优点:**并行、一次一密、不传递误差**
缺点:**主动攻击(改明文，后续内容不影响，只要误差不传递该缺点就存在)**

**总结**

- **分组**模式: ECB、CBC和CTR;
  **流**模式: CFB、OFB
- **传递误差**: CBC、CFB
  **不传递误差**: ECB、OFB和CTR
- **可并行**: ECB、CTR
  **不可并行**: CBC、OFB、CFB

##### 加密

流程图：

![](PIC\158.png)

**1.密钥加法层**

![](PIC\159.png)

其中的明文矩阵为字节表示的4x4的矩阵，而**状态矩阵是将明文矩阵转为十六进制后的矩阵**。

**2.字节代换层**

![](PIC\160.png)

![](PIC\161.png)

**3.行位移**

> ![](PIC\163.png)

![](PIC\164.png)

**4.列混淆**

AES算法中**最复杂的部分**，混淆输入矩阵的每一列

![](PIC\165.png)

我们发现在矩阵乘法中，出现了加法和乘法运算，我们前面也提到过在**扩展域中加法操作等同于异或运算**，而乘法操作需要一个特殊的方式进行处理，于是我们就先把代码中的加号换成异或符号，然后将**伽罗瓦域的乘法定义成一个有两个参数的函数**，并让他返回最后计算结果。

**不同之处在于使用的左乘矩阵不同，它与正向列混淆的左乘矩阵互为逆矩阵，也就是说，数据矩阵同时左乘这两个矩阵后，数据矩阵不会发生任何变化。**

- **正向**列混淆：用于**加密**
- **逆向**列混淆：用于**解密**

![](PIC\166.png)

![](PIC\167.png)

**最后应该注意要将密文结果从矩阵形式还原成字符串形式输出**

##### 密钥生成

![](PIC\168.png)

**子密钥的生成是以列为单位进行的，一列是32Bit，四列组成子密钥共128Bit。生成子密钥的数量比AES算法的轮数多一个，因为<u>第一个密钥加法层进行密钥漂白时也需要子密钥</u>。密钥漂白是指在AES的输入和输出中都使用的子密钥的XOR加法。**

**子密钥在图中都存储在W[0]、W[1]、...、W[43]的扩展密钥数组之中。k1-k16表示原始密钥对应的字节，而图中子密钥k0与原始子密钥相同。在生成的扩展密钥中W的下标如果是4的倍数时(从零开始)需要对异或的参数进行G函数处理**

**扩展密钥生成有关公式如下：**

![](PIC\169.png)

**生成S盒的过程：**

经过**两个步骤**计算而来，有很强的代数结构

![](PIC\173.png)

**S盒的仿射映射**

![](PIC\174.png)

![175](PIC\175.png)

**生成逆S盒的过程：**

![](PIC\176.png)

##### 解密

流程图：

![](PIC\170.png)

##### 补充数学知识

**欧几里得算法**

**gcd：最大公约数**

![](PIC\171.png)

**欧几里得算法代码**

```c++
//输入两个正整数r0>r1，输出计算结果 
int gcd(int r0, int r1)
{
	int r = 0;
     while(r1 != 0)
     { 
     	r   =   r0   %   r1; 
     	r0   =   r1; 
     	r1   =   r; 
     } 
     return r0; 
}
```

扩展欧几里得算法是为了**计算乘法逆元**

![](PIC\172.png)



#### SM4

中国自主研发的加密算法

**密钥长度和明文长度都是128位**

基本结构

![](PIC\177.png)

**流程**

![178](C:\CHARLES\Personal\专业\网络安全\现代密码学\PIC\178.png)

![179](C:\CHARLES\Personal\专业\网络安全\现代密码学\PIC\179.png)

![](PIC\180.png)

##### 密钥扩展

![](PIC\183.png)

![184](PIC\184.png)

##### 加密算法

![](PIC\181.png)

![182](PIC\182.png)

![](PIC\185.png)

![186](PIC\186.png)

##### 解密

解密变换和加密变换结构相同，不同的只是**轮密钥的使用顺序**

![](PIC\187.png)

### Feistel网络

所需参数：

- **分组大小**
- **密钥大小**
- **轮数**
- **子密钥产生算法**
- **轮函数**

![](PIC\138.png)

**结构图**

![](PIC\139.png)

正确性证明：

![](PIC\140.png)

#### **DES**

DES是一种**对称加密算法**（对称加密即加密和解密用的是同一个秘钥），又称为**美国数据加密标准**。

DES的密钥长64位，实际上只有56位密钥参与了DES运算（第8/16/24/32/40/48/56/64位是校验位）。

明文按64位进行分组，分组后的明文块和密钥通过DES加密后形成一个密文块，所有的密文块拼到一起输出就是密文。由于DES是对称加密，就要求发送方和接收方使用相同的密钥进行加密和解密，所以在传输数据之前双方得约定好密钥。

- **分组长度64bit**
- **密文分组长度64bit**
- **密钥长度56位**

流程：

1. **输入明文**
2. **IP置换**
3. **密钥控制的16轮迭代**
4. **32位互换+IP逆置换**
5. **输出加密数据**

**DES算法框图: <u>每一轮都是Feistel结构</u>**![141](PIC\141.png)

**算法流程**

![](PIC\142.png)

##### 初始置换IP和逆初始置换

密码意义上作用不大，**<u>用于打乱原来输入x的ASCII码划分关系</u>**

![](PIC\143.png)

##### 轮函数

**本质是一种对合变换（连续两次变换会变回原来的值）的复合**，即F(F（x，y)） = （x，y）

![](PIC\144.png)

**扩展运算 E** 32位扩展到48位

![](PIC\145.png)

**压缩运算 S** 48位压缩到32位，4*16的矩阵

![](PIC\146.png)

![](PIC\147.png)

**P盒置换**

![](PIC\148.png)

##### 密钥编排

![](PIC\149.png)

**后续**

![](PIC\150.png)

![](PIC\151.png)

##### 3DES

多重DES就是**使用多个密钥，利用DES对明文进行多次加密**，使用多重DES可以增加密钥量

**中间相遇攻击**

![](PIC\152.png)

 **双密钥三重DES算法**

![](PIC\153.png)